---
title: "Adelanto-Proyecto final"
author: "Arturo Pulido Balderas y valentina Ruiz Soto"
format: pdf
editor: visual
---

Introducción 
El metano (CH4) es un compuesto gaseoso constituido por un átomo de carbono y cuatro de hidrógeno. Es considerado el segundo gas de efecto invernadero que más contribuye a los efectos del cambio climático.

Se estima que cada tonelada de metano en la atmósfera posee los mismos efectos de retención calorífica equivalentes a 80 toneladas de dióxido de carbono. Por ello, el metano es responsable directamente del 30% de los efectos del cambio climático a escala global, convirtiéndolo en una de las principales amenazas que enfrentan los socioecosistemas en la actualidad. (IEA,2025). El estudio de núcleos de hielo de la Antártida y Groenlandia han permitido a los científicos determinar su concentración histórica en la atmósfera. La cuál se duplicó de 700 partes por billón en los años 1800 hasta la concentración actual de 1943 para 2025. (NASA, 2025).

El gas metano es emitido a la atmósfera de forma natural por humedales, océanos, erupciones volcánicas y organismos como las termitas. Sin embargo, el 60% de las emisiones actuales son de origen antrópico. De la cuales el 90% son emitidos por tres sectores específicos: Agricultura (60%), quema de combustibles fósiles (35%) y residuos de la ganadería (20%).

Dicha información es obtenida vía satélite por proyectos de observación de la Tierra especializados en el estudio de emisiones de metano. Por ejemplo, el satélite Sentinel-5P de la Agencia Espacial Europea (ESA) es capaz de diferenciar entre emisiones antrópicas y naturales produciendo mapas de concentración y emisión de metano a escala global de libre acceso para científicos de todo el mundo (ESA,2023).

A su vez, el aumento de las temperaturas globales propicia la liberación de metano de los reservorios naturales como el permafrost y fomenta los procesos de eutrofización. (Earth.org, 2022).

Dados los impactos del gas metano a escala planetaria, resulta toral el desarrollo de investigación científica con el objetivo de comprender los procesos de emisión y absorción de metano para el desarrollo de estrategias de gestión sostenibles.

El presente estudio de caso utiliza una base de datos de emisión de metano por países, regiones y sectores económicos desarrollada por la International Energy Agency (IEA) con el objetivo de desarrollar un análisis estadístico que clasifique a los países por emisión, identifique la relación estadística entre regiones geográficas y emisiones, y produzca un modelo de redes de relación de variables.

```{r}
install.packages("pacman")
library(pacman)
p_load("ggplot2", "readr", "dplyr", "stats", "shiny")
```

```{r}
#Abrimos la base de datos
IEA <- read.csv("IEA.csv")
head(IEA)
```

```{r}
colnames(IEA)[3] <- "emissions"
#La columna emisiones tiene las unidades de kilotoneladas (kt)
```

Gráfico emisiones por región.

```{r}
# Sumamos las emisiones de cada región
resumen <- aggregate(IEA$emissions, by = list(Region = IEA$region), sum)
resumen <- resumen[-9,] #Eliminar la suma total
colnames(resumen) <- c("Region", "Emissions")

# Producimos el gráfico
ggplot(data = resumen, aes(x = reorder(Region, Emissions), y = Emissions)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() +
  labs(title = "Emisiones por Región",
       x = "Región",
       y = "Emisiones (kt)") +
  theme_minimal()

```

Gráfico por países con mayor y menor emisión

```{r}
# Limiamos la base de datos
IEA_limpio <- IEA %>% filter(!is.na(country))

# Ordenar los datos según las emisiones de cada país
IEA_ordenado <- IEA_limpio %>% arrange(desc(emissions))


```

```{r}
# Seleccionar los países más emisores y ordenarlos de mayor a menor
top_paises <- IEA_ordenado[order(IEA_ordenado$emissions, decreasing = TRUE), ][1:10, ]

# Convertir 'country' en un factor con niveles ordenados
top_paises$country <- factor(top_paises$country, levels = top_paises$country)

# Gráfico para los países más emisores
grafico_top <- ggplot(top_paises, aes(x = country, y = emissions)) +
  geom_bar(stat = "identity", fill = "red") +
  coord_flip() +
  labs(title = "Top Países Más Emisores",
       x = "País",
       y = "Emisiones (kt)") +
  theme_minimal()

print(grafico_top)
```

Gráfico ordenado

```{r}
# Ordenamos los países por emisión
top_paises <- IEA_ordenado %>% filter(country %in% c("China", "United States", "Russia", "India", "Brazil", "Other"))

top_paises$country <- factor(top_paises$country, levels = c("China", "United States", "Russia", "India", "Brazil", "Other"))

# Gráfico para los países más emisores
grafico_top <- ggplot(top_paises, aes(x = country, y = emissions)) +
  geom_bar(stat = "identity", fill = "red") +
  coord_flip() +
  labs(title = "Top Países Más Emisores",
       x = "País",
       y = "Emisiones (kt)") +
  theme_minimal()

print(grafico_top)

```

```{r}
# Seleccionar los países menos emisores 
bottom_paises <- tail(IEA_ordenado[IEA_ordenado$emissions > 0,], 10) %>% arrange(desc(emissions))
# Gráfico para los países menos emisores
grafico_bottom <- ggplot(bottom_paises, aes(x = reorder(country, emissions), y = emissions))+
  geom_bar(stat = "identity", fill = "green") +
  coord_flip() +
  labs(title = "Top Países Menos Emisores",
       x = "País",
       y = "Emisiones (kt)") +
  theme_minimal()

print(grafico_bottom)
```

Gráfico ordenado

```{r}
# Filtramos los países menos emisores en el nuevo orden
bottom_paises <- IEA_ordenado %>% filter(country %in% c("Uzbekistan", "Germany", "South Sudan", "Netherlands", "Norway", "Slovenia"))

bottom_paises <- bottom_paises %>% arrange(match(country, c("Uzbekistan", "Germany", "South Sudan", "Netherlands", "Norway", "Slovenia")))

# Convertir 'country' en un factor con niveles predefinidos
bottom_paises$country <- factor(bottom_paises$country, levels = c("Uzbekistan", "Germany", "South Sudan", "Netherlands", "Norway", "Slovenia"))

grafico_bottom <- ggplot(bottom_paises, aes(x = country, y = emissions)) +
  geom_bar(stat = "identity", fill = "green") +
  coord_flip() +
  labs(title = "Top Países Menos Emisores",
       x = "País",
       y = "Emisiones (kt)") +
  theme_minimal()

print(grafico_bottom)
```

Análisis de regresion multivariable utilizandop emsiones, región e industria (energética, agricultura, residuos y otros.)

```{r}
# Filtrar datos para incluir Energy, Agriculture, Waste y Other
IEA_selected <- IEA_limpio %>% filter(type %in% c("Energy", "Agriculture", "Waste", "Other"))

# Convertir las variables categóricas en factores
IEA_selected$region <- as.factor(IEA_selected$region)
IEA_selected$type <- as.factor(IEA_selected$type)

# Realizar análisis de regresión multivariable
modelo_multi <- lm(emissions ~ region + type, data = IEA_selected)

# Resumen del modelo
summary(modelo_multi)
```

Tablas de resumen para tener solo 2 variables

```{r}
IEA_limpio$country <- as.factor(IEA_limpio$country) #Paises como factor

#Dataframe con la suma de emisiones de cada tipo de fuente, para cada país
sumas_pais <- IEA_limpio %>% group_by(country, type) %>% 
  summarise("emi" = sum(emissions))

#Dataframe solo con país y región, sin duplicados
pais_region <- IEA_limpio[c(1,2)]
pais_region <- pais_region[!duplicated(pais_region$country),]

#Agregar la region correspondiente a cada pais en tabla de sumas

sumas_pais <- pais_region %>% inner_join(sumas_pais, by = "country", keep = F)

sumas_pais
```

```{r}
# Cargamos la base de datos limpia
IEA_selected <- IEA_limpio %>% filter(type %in% c("Energy", "Agriculture", "Waste", "Other"))

# Incluímos el el dashboard el código para graficar países con mayores y menoires emisiónes. 

top_paises <- IEA_ordenado %>% filter(country %in% c("China", "United States", "Russia", "India", "Brazil", "Other"))
top_paises$country <- factor(top_paises$country, levels = c("China", "United States", "Russia", "India", "Brazil", "Other"))

bottom_paises <- IEA_ordenado %>% filter(country %in% c("Uzbekistan", "Germany", "South Sudan", "Netherlands", "Norway", "Slovenia"))
bottom_paises$country <- factor(bottom_paises$country, levels = c("Uzbekistan", "Germany", "South Sudan", "Netherlands", "Norway", "Slovenia"))

# Definimos la interfaz de usuario para seleccionar el país de interés.
ui <- fluidPage(
  titlePanel("Dashboard de Emisiones por Sectores y Países"),
  sidebarLayout(
    sidebarPanel(
      selectInput("country", "Selecciona un país:", 
                  choices = unique(IEA_selected$country),
                  selected = "United States")
    ),
  
    mainPanel(
      plotOutput("graficoSector"),
      plotOutput("graficoTop"),
      plotOutput("graficoBottom")
    )
  )
)

#Establecemos el código para graficar la emisión por tipo de industria
server <- function(input, output) {
  
  output$graficoSector <- renderPlot({
    sector_pais <- IEA_selected %>%
      filter(country == input$country) %>%
      group_by(type) %>%
      summarise(Emissions = sum(emissions))
    
    ggplot(sector_pais, aes(x = reorder(type, -Emissions), y = Emissions, fill = type)) +
      geom_bar(stat = "identity") +
      labs(title = paste("Emisiones por Sector en", input$country),
           x = "Sector",
           y = "Emisiones (kt)") +
      theme_minimal()
  })
  
  output$graficoTop <- renderPlot({
    ggplot(top_paises, aes(x = country, y = emissions)) +
      geom_bar(stat = "identity", fill = "red") +
      labs(title = "Top Países Más Emisores", x = "País", y = "Emisiones (kt)") +
      theme_minimal()
  })
  
  output$graficoBottom <- renderPlot({
    ggplot(bottom_paises, aes(x = country, y = emissions)) +
      geom_bar(stat = "identity", fill = "green") +
      labs(title = "Top Países Menos Emisores", x = "País", y = "Emisiones (kt)") +
      theme_minimal()
  })
}

# Abrimos el dashboard
shinyApp(ui = ui, server = server)
```

Análisis de resultados:

Derivado de los análisis estadísticos se obtuvieron los siguientes resultados:

El valor de R cuadrada obtenido de análisis de regresión multivariable es (0.08626). lo cual indica que dicho modelo explica aproximadamente el 8.6% de la variabilidad entre variables.

Al tratarse de una cifra reducida se concluye que existen factores y variables independientes que no se han considerado en el modelo o no pueden explicarse únicamente con la información disponible.

Las regiones Asia-Pacific, North America y Russian-Caspian poseen un alto nivel de significancia con tipos de emisiones específicas. Lo cual, indica que las emisiones de metano son producidas en su mayor parte por un solo tipo de industria en la región.

Los P values obtenidos por sector son:

Sector energético (2e-16) Residuos: (0.000169) Otros: (1.70e-12)

Lo cuál indican que su significancia estadística es menor en comparación con la variable agriculture.



Conclusiones:

El análisis de redes demuestra que los sectores con mayor producción de metano son la agricultura, construcción y emisiones no controladas. 

Dado que las flechas más largas denotan mayores emisiones, se observa lo siguiente: 

El Sureste asiático y del Pacífico tiene las mayores emisiones en los sectores de agricultura y construcción, probablemente relacionada a la alta producción de leguminosas y cereales. Por ejemplo, los cultivos de arroz, los cuales son cultivados en planicies o terrazas inundadas fomentando la producción de humedales. 

Se concluye que las emisiones de Norteamérica se diversifican en diversos sectores de la economía al encontrarse en el centro del gráfico de redes.

Para la regulación de emisiones de metano se debe diversificar y limitar los sectores agrícolas y de construcción. Mientras que el primer sector es más difícil de reducir por las implicaciones socioculturales, las emisiones de construcción se podrían reducir si se promueve el uso de materiales sustentables a diferencia del concreto.

El desarrollo de estrategias exitosas de mitigación de emisiones de metano depende de su adaptabilidad a los socioecosistemas de cada región. Puesto que cada país tiene necesidades y fuentes de emisión específicas.


Referencias

IEA – International Energy Agency. (2025). Methane https://www.iea.org/

Methane \| Vital Signs – Climate Change. (NASA, 2025) https://climate.nasa.gov/vital-signs/methane/?intent=121

(Earth.org, 2022). What Are the Major Sources of Methane in the Atmosphere? https://earth.org/sources-of-methane-in-the-atmosphere/

Trio of Sentinel satellites map methane super-emitters. (ESA, 2023). https://www.esa.int/Applications/Observing_the_Earth/Copernicus/Trio_of_Sentinel \_satellites_map_methane_super-emitters
